{% extends "base.html" %}
{% import "partials/icons.html" as icons %}
{% import "partials/detail_cards.html" as cards %}
{% import "partials/image_section.html" as img %}
{% block title %}Booklog Â· Edit Author{% endblock %}
{% block content %}
  <header>
    <h1 class="text-2xl font-semibold">Edit Author</h1>
  </header>

  <section data-signals:_submitting="false" data-signals:_submit-error="''">
    <form
      class="flex flex-col gap-6 pb-16 md:pb-0"
      data-on:submit="$_submitting = true; $_submitError = ''; @put('/api/v1/authors/{{ id }}', {contentType: 'form'})"
      data-on:datastar-fetch="if (!$_submitting) return; if (evt.detail.type === 'finished') { sessionStorage.setItem('toast', 'Author updated'); window.location.href = '/authors/' + '{{ id }}' } else if (evt.detail.type === 'error') { $_submitting = false; $_submitError = 'Save failed. Please try again.' }"
    >
      <div class="grid gap-4 sm:grid-cols-2">
        <label class="flex flex-col gap-1 text-sm">
          <span
            class="text-xs font-semibold text-text-muted uppercase tracking-wide"
            >Name*</span
          >
          <input
            type="text"
            name="name"
            value="{{ name }}"
            required
            aria-required="true"
            class="input-field"
          />
        </label>
      </div>
      {{ img::deferred_upload_with_preview("author-image", "Author image", "author", id, image_url) }}
      {{ cards::edit_form_actions() }}
    </form>
  </section>
{% endblock %}
